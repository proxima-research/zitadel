{{template "main-top" .}}

<div class="lgn-head">
    <h1>{{t "LoginAs.Title"}}</h1>

    {{ template "user-profile" . }}

    <p>{{t "LoginAs.SelectUserLogin" }}</p>
</div>

{{template "error-message" .}}
<form class="lng-login-as-search" action="{{ userSelectionUrl }}" method="POST">
    {{ .CSRF }}
    <input type="hidden" name="authRequestID" value="{{ .AuthReqID }}" />
    <input type="hidden" name="userID" value="{{ .UserId }}" />
    <input type="hidden" name="loginAs" value="1" />
    <input type="hidden" name="page" value="0" />
    <input type="text" class="lng-login-as-search-field" name="search" value="{{ .Search }}" />
</form>

<form class="lng-login-as-users" action="{{ loginAsUrl }}" method="POST">

    {{ .CSRF }}

    <input type="hidden" name="authRequestID" value="{{ .AuthReqID }}" />
    <input type="hidden" name="userID" value="{{ .UserId }}" />
    <input type="hidden" name="loginAs" value="1" />
    <input type="hidden" name="page" value="{{ .Page }}" />
    <input type="hidden" name="search" value="{{ .Search }}" />

    <div class="lgn-account-selection">
        {{ range $user := .Users }}
        <button type="submit" name="loginAsName" value="{{ $user.LoginName }}" class="lgn-account">
            <div class="left">
                <div class="lgn-avatar" {{if not $user.AvatarKey}}loginname="{{ $user.LoginName }}"{{end}}>
                    {{if $user.AvatarKey}}
                    <img class="avatar-img" src="{{ avatarResource $user.ResourceOwner $user.AvatarKey }}" alt="user-avatar">
                    {{else}}
                    <span class="initials">A</span>
                    {{end}}
                </div>
            </div>
            <div class="lgn-names">
                <p class="lgn-displayname">{{$user.DisplayName}}</p>
                <p class="lgn-loginname">{{$user.Email}}</p>
            </div>
            <span class="fill-space"></span>
            <i class="lgn-icon-angle-right-solid"></i>
        </button>
        {{ end }}
    </div>
</form>

<form class="lng-login-as-nav" action="{{ userSelectionUrl }}" method="POST">
    {{ .CSRF }}
    <input type="hidden" name="authRequestID" value="{{ .AuthReqID }}" />
    <input type="hidden" name="userID" value="{{ .UserId }}" />
    <input type="hidden" name="loginAs" value="1" />
    <input type="hidden" name="search" value="{{ .Search }}" />
    {{if (gt .PrevPage -1) }}
    <button type="submit" name="page" value="{{ .PrevPage }}" class="lgn-raised-button lgn-primary"><<<</button>
    {{ end }}
    {{if (gt .NextPage 0) }}
    <button type="submit" name="page" value="{{ .NextPage }}" class="lgn-raised-button lgn-primary right">>>></button>
    {{ end }}
</form>

{{template "main-bottom" .}}

<script src="{{ resourceUrl "scripts/form_submit.js" }}"></script>
<script src="{{ resourceUrl "scripts/default_form_validation.js" }}"></script>
